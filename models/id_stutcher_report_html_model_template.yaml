models:
  - name: id_stitcher_report
    model_type: report_model
    model_spec:
      materialization:
        output_type: report
        run_type: discrete
      html: |
        {%- set query_models = [this.DeRef("models/clusters"), this.DeRef("models/overall_stats"), this.DeRef("models/clusters_sorted_by_size"), this.DeRef("models/clusters_sorted_by_dist"), this.DeRef("models/top_max_degree_nodes"), this.DeRef("models/edges_graph"), this.DeRef("models/edges_biggest_cluster"), this.DeRef("models/id_type_count"), this.DeRef("models/id_count")] -%}

        <!DOCTYPE html>
        <html lang="en">

        <head>
            <title>
                ID Stitcher Report
            </title>
            <style>
                .table-container {
                    margin-bottom: 3em;
                }

                .table-container table {
                    border-collapse: collapse;
                    width: 50%;
                }

                .table-container th, .table-container td {
                    border: 1px solid #dddddd;
                    text-align: left;
                    padding: 0.5em;
                }

                .table-container th {
                    background-color: #f2f2f2;
                }

                img {
                    max-width: 100%;
                    height: auto;
                    display: block;
                    margin: 1em auto;
                }
            </style>            
        </head>

        <body style="text-align:center">
            <h1 style="color: green">
                Testing
            </h1>

            <h2>Tables</h2>
            {% for qmodel in query_models %}
              {{ table.StoreToJSON(qmodel.String()+".json") }}
              {% with table = qmodel.RunEphemeralSelector(-1) %}
              <div class="table-container">
                  <h3>{{ qmodel.GetModel().Name() }}</h3>
                  <table>
                      <thead>
                          <tr>
                              {% for column in table.Columns %}
                                  <th>{{ column }}</th>
                              {% endfor %}
                          </tr>
                      </thead>
                      <tbody>
                          {% for row in table.Results %}
                              <tr>
                                  {% for value in row %}
                                      <td>{{ value }}</td>
                                  {% endfor %}
                              </tr>
                          {% endfor %}
                      </tbody>
                  </table>
              </div>
              {% endwith %}

            {% endfor %}


        </body>

        </html>
